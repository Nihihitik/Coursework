# Документация по Фронтенд Части Проекта

## Обзор

Фронтенд часть проекта разработана с использованием Next.js (App Router), TypeScript, Tailwind CSS и Shadcn UI. Она обеспечивает пользовательский интерфейс для взаимодействия с бэкендом, включая просмотр автомобилей, регистрацию, авторизацию и управление личным кабинетом для покупателей и продавцов.

## Основные Технологии

*   **Next.js (App Router):** Современный фреймворк для React, использующий файловую систему для маршрутизации (App Router). Обеспечивает рендеринг на стороне сервера (SSR) и статическую генерацию сайтов (SSG).
*   **TypeScript:** Строго типизированный язык программирования, который добавляет статическую типизацию к JavaScript, улучшая надежность и поддерживаемость кода.
*   **Tailwind CSS:** Утилитарный CSS-фреймворк, позволяющий быстро создавать кастомные дизайны непосредственно в HTML/JSX разметке.
*   **Shadcn UI:** Коллекция повторно используемых UI-компонентов, построенных на Tailwind CSS и Radix UI, которые можно легко кастомизировать.
*   **Axios:** HTTP-клиент для выполнения запросов к бэкенду.
*   **Zustand (потенциально):** Хотя явно не указано в файлах, Zustand является предпочтительным решением для управления глобальным состоянием согласно правилам.
*   **Standard.js:** Стиль кода, используемый в проекте для JavaScript/TypeScript.

## Структура Проекта (Основные Директории и Файлы)

### `frontend/src/app/`

Это корневая директория для всех страниц и маршрутов приложения, согласно концепции App Router в Next.js.

*   **`layout.tsx`**: Основной макет приложения. Здесь определяются общие элементы интерфейса, такие как шапка, подвал, и метаданные страницы.
*   **`page.tsx`**: Главная страница приложения (маршрут `/`). Отображает Hero-секцию, поиск и фильтрацию автомобилей, а также список доступных автомобилей.
    *   **Взаимодействие с API:**
        *   Получение списка всех автомобилей (`/cars`) с возможностью фильтрации.
*   **`globals.css`**: Глобальные стили для всего приложения.
*   **`favicon.ico`**: Иконка сайта.

### `frontend/src/app/auth/`

Директория, отвечающая за страницы и логику аутентификации.

*   **`login/page.tsx`**: Страница входа пользователя.
    *   **Взаимодействие с API:**
        *   Отправка данных для входа (`/auth/token`).
*   **`register/`**: Директория для страниц регистрации.
    *   **`buyer/page.tsx`**: Страница регистрации покупателя.
        *   **Взаимодействие с API:**
            *   Отправка данных для регистрации покупателя (`/auth/register/buyer`).
    *   **`seller/page.tsx`**: Страница регистрации продавца.
        *   **Взаимодействие с API:**
            *   Отправка данных для регистрации продавца (`/auth/register/seller`).

### `frontend/src/app/cars/`

Раздел, связанный с отображением информации об автомобилях.

*   **`page.tsx`**: Страница каталога автомобилей (маршрут `/cars`). Похожа на главную страницу, но может иметь специфичные для каталога элементы.
    *   **Взаимодействие с API:**
        *   Получение списка всех автомобилей (`/cars`) с фильтрацией.
*   **`[id]/page.tsx`**: Динамическая страница для отображения детальной информации о конкретном автомобиле (маршрут `/cars/{id}`).
    *   **Взаимодействие с API:**
        *   Получение данных конкретного автомобиля по его ID (`/cars/{id}`).
        *   Добавление/удаление автомобиля из избранного (потенциально, если такая логика есть на этой странице).

### `frontend/src/app/dashboard/`

Раздел личного кабинета пользователя.

*   **`layout.tsx`**: Общий макет для страниц личного кабинета. Может содержать навигацию по разделам кабинета.
*   **`page.tsx`**: Корневая страница личного кабинета (маршрут `/dashboard`). Осуществляет редирект на страницу покупателя или продавца в зависимости от роли пользователя, сохраненной в `localStorage`.
*   **`buyer/page.tsx`**: Личный кабинет покупателя (маршрут `/dashboard/buyer`).
    *   **Взаимодействие с API:**
        *   Получение данных профиля пользователя (`/users/profile`).
*   **`seller/`**: Раздел личного кабинета для продавцов.
    *   **`page.tsx`**: Главная страница личного кабинета продавца (маршрут `/dashboard/seller`). Отображает приветствие, ссылки на управление автомобилями и профилем, а также список последних добавленных автомобилей.
        *   **Взаимодействие с API:**
            *   Получение данных профиля пользователя (`/users/profile`).
            *   Получение списка автомобилей продавца (`/seller/cars`).
    *   **`cars/page.tsx`**: Страница управления автомобилями продавца (маршрут `/dashboard/seller/cars`). Отображает полный список автомобилей продавца с возможностью добавления новых и редактирования существующих.
        *   **Взаимодействие с API:**
            *   Получение списка автомобилей продавца (`/seller/cars`).
    *   **`cars/add/page.tsx`**: Страница добавления нового автомобиля продавцом (маршрут `/dashboard/seller/cars/add`).
        *   **Взаимодействие с API:**
            *   Отправка данных для добавления нового автомобиля (`/cars`).
    *   **`cars/[id]/edit/page.tsx` (Предполагается наличие):** Страница редактирования существующего автомобиля продавцом.
        *   **Взаимодействие с API:**
            *   Получение данных автомобиля для редактирования (`/cars/{id}`).
            *   Отправка обновленных данных автомобиля (`/cars/{id}`).

### `frontend/src/app/favorites/`

Раздел для отображения избранных автомобилей пользователя.

*   **`page.tsx`**: Страница избранных автомобилей (маршрут `/favorites`).
    *   **Взаимодействие с API:**
        *   Получение списка избранных автомобилей пользователя (`/favorites`).
        *   Удаление автомобиля из избранного (`/favorites/{carId}`).

### `frontend/src/components/`

Директория для переиспользуемых UI-компонентов.

*   **`ui/`**: Компоненты из библиотеки Shadcn UI (например, `Button`, `Input`, `Card`, `Select`, `Checkbox`, `Label`, `Slider`). Эти компоненты используются для построения пользовательского интерфейса на всех страницах.

### `frontend/src/lib/`

Вспомогательные модули и утилиты.

*   **`api.js`**: Централизованный модуль для взаимодействия с бэкенд API.
    *   Создает экземпляр `axios` с базовым URL и настройками.
    *   **Перехватчики (Interceptors):**
        *   **Request Interceptor:** Добавляет токен авторизации (`Bearer token`) к каждому исходящему запросу, если токен присутствует в `localStorage`.
        *   **Response Interceptor:** Обрабатывает ошибки ответов. В частности, при ошибке 401 (Unauthorized) очищает токен и роль пользователя из `localStorage` и перенаправляет на страницу входа (`/auth/login`).
    *   **Экспортируемые функции для работы с API:**
        *   `loginUser(email, password)`: POST `/auth/token`
        *   `registerBuyer(buyerData)`: POST `/auth/register/buyer`
        *   `registerSeller(sellerData)`: POST `/auth/register/seller`
        *   `getUserProfile()`: GET `/users/profile`
        *   `getAllCars(filters = {})`: GET `/cars` (с параметрами фильтрации)
        *   `getCarById(id)`: GET `/cars/{id}`
        *   `addCarToFavorites(carId)`: POST `/favorites`
        *   `removeFromFavorites(carId)`: DELETE `/favorites/{carId}`
        *   `getUserFavorites()`: GET `/favorites`
        *   `addCar(carData)`: POST `/cars` (для добавления автомобиля продавцом)
        *   `updateCar(id, carData)`: PUT `/cars/{id}` (для обновления автомобиля продавцом)
        *   `deleteCar(id)`: DELETE `/cars/{id}` (для удаления автомобиля продавцом)
        *   `getSellerCars()`: GET `/seller/cars`

### `frontend/public/`

Директория для статических файлов, которые доступны напрямую по URL (например, изображения, шрифты).

### Корневые Файлы Конфигурации

*   **`next.config.js`**: Конфигурационный файл Next.js. Может содержать настройки для проксирования API запросов, оптимизации изображений, переменных окружения и т.д. В данном проекте, вероятно, настроен прокси для запросов к бэкенду, чтобы избежать проблем с CORS в режиме разработки (например, запросы с `localhost:3000` на `localhost:8000`).
*   **`package.json`**: Определяет зависимости проекта, скрипты для сборки, запуска и тестирования.
*   **`tsconfig.json`**: Конфигурационный файл TypeScript.
*   **`postcss.config.mjs`**: Конфигурация PostCSS (используется Tailwind CSS).
*   **`components.json`**: Конфигурационный файл для Shadcn UI, определяющий пути к компонентам и стилям.

## Аутентификация и Управление Сессией

*   Аутентификация основана на JWT токенах.
*   После успешного входа (логин или регистрация), токен авторизации (`auth_token`) и роль пользователя (`user_role`) сохраняются в `localStorage`.
*   Токен автоматически добавляется ко всем API запросам через перехватчик в `src/lib/api.js`.
*   При ошибке 401 (Unauthorized) или если токен отсутствует/невалиден, пользователь автоматически перенаправляется на страницу входа.
*   Роль пользователя используется для предоставления доступа к соответствующим разделам личного кабинета (`/dashboard/buyer` или `/dashboard/seller`).

## Работа с API

*   Все запросы к бэкенду инкапсулированы в файле `src/lib/api.js`.
*   Используется `axios` для выполнения HTTP-запросов.
*   Базовый URL API (`http://localhost:8000`) настраивается через переменные окружения (`NEXT_PUBLIC_API_URL`) или используется значение по умолчанию.
*   Функции в `api.js` абстрагируют детали выполнения запросов и возвращают промисы с данными ответа.

## Маршрутизация

*   Используется App Router из Next.js. Маршруты определяются структурой папок и файлов в директории `src/app`.
*   Динамические маршруты (например, `/cars/[id]`) используют квадратные скобки в имени файла/папки.

## Состояние Приложения

*   Локальное состояние компонентов управляется с помощью хуков React (`useState`, `useEffect`).
*   Глобальное состояние, если оно необходимо в более сложных сценариях, рекомендуется управлять с помощью Zustand (согласно правилам проекта). В текущей структуре явного использования Zustand не наблюдается, но это может быть добавлено по мере усложнения приложения.
*   Данные, полученные от API, обычно хранятся в состоянии соответствующих страниц или компонентов.

## Стилизация

*   **Tailwind CSS** используется для основной стилизации и создания утилитарных классов.
*   **Shadcn UI** предоставляет готовые, стилизованные компоненты, которые можно легко интегрировать и кастомизировать.
*   Глобальные стили определены в `src/app/globals.css`.
*   Локальные стили для компонентов (если не покрываются Tailwind/Shadcn) могут быть реализованы с использованием CSS Modules или других подходов, но в текущей структуре это не выделено.

## Важные Аспекты и Возможные Улучшения

*   **Обработка ошибок:** Базовая обработка ошибок есть в `api.js` и на страницах (например, вывод сообщения об ошибке при загрузке данных). Может быть расширена для более детального информирования пользователя.
*   **Валидация форм:** Валидация на стороне клиента для форм регистрации, входа, добавления/редактирования автомобиля (например, с использованием Zod или React Hook Form).
*   **Оптимизация производительности:**
    *   Использование `React.memo`, `useCallback`, `useMemo` для предотвращения ненужных ре-рендеров.
    *   Ленивая загрузка (Lazy Loading) для компонентов и изображений.
    *   Оптимизация изображений (формат WebP, размеры).
*   **Тестирование:** Написание юнит-тестов (Jest, React Testing Library) и интеграционных тестов.
*   **Доступность (a11y):** Обеспечение соответствия стандартам доступности.
*   **Интернационализация (i18n):** Если приложение будет поддерживать несколько языков.
*   **Управление состоянием запросов:** Для более сложных сценариев можно рассмотреть использование библиотек типа React Query (TanStack Query) для кэширования, синхронизации и обновления серверного состояния.

Этот документ предоставляет общее представление о фронтенд части проекта. Для более глубокого понимания рекомендуется изучать исходный код конкретных страниц и компонентов.
